<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ„Ÿæ©ç§å­ (Gratitude Seed)</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --primary: #5D5CDE;
            --primary-light: #8584E9;
            --primary-dark: #4342A0;
            --secondary: #FF9D5C;
            --secondary-light: #FFB78C;
            --secondary-dark: #E57F40;
            --tertiary: #52C49F;
            --tertiary-light: #7CE1C2;
            --tertiary-dark: #3AA781;
            --text-primary: #333333;
            --text-secondary: #555555;
            --background-light: #FFFFFF;
            --background-dark: #181818;
            --card-light: #F9F9F9;
            --card-dark: #222222;
        }

        .dark {
            --text-primary: #F5F5F5;
            --text-secondary: #DDDDDD;
            --background-light: #181818;
            --background-dark: #121212;
            --card-light: #222222;
            --card-dark: #2A2A2A;
        }

        body {
            font-family: 'Rubik', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--background-light);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .button {
            background-color: var(--primary);
            color: white;
            border-radius: 20px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(93, 92, 222, 0.2);
            position: relative;
            overflow: hidden;
        }

        .button:active {
            transform: scale(0.96);
        }

        .button-secondary {
            background-color: var(--secondary);
            box-shadow: 0 4px 6px rgba(255, 157, 92, 0.2);
        }

        .button-tertiary {
            background-color: var(--tertiary);
            box-shadow: 0 4px 6px rgba(82, 196, 159, 0.2);
        }

        .button-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            box-shadow: none;
        }

        .card {
            background-color: var(--card-light);
            border-radius: 24px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .dark .card {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .dark .card:hover {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .input {
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 16px;
            transition: all 0.2s ease;
            background-color: var(--background-light);
            color: var(--text-primary);
        }

        .input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.2);
            outline: none;
        }

        .tab-active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            font-weight: 600;
        }

        .tab {
            padding: 12px 16px;
            transition: all 0.2s ease;
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .bounce {
            animation: bounce 0.5s ease-in-out;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .seed-card {
            position: relative;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .seed-card:hover {
            transform: translateY(-10px) scale(1.02);
        }

        .seed-card::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--tertiary));
            z-index: -1;
            border-radius: 16px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .seed-card:hover::after {
            opacity: 0.5;
        }

        .badge {
            background-color: var(--secondary-light);
            color: white;
            border-radius: 20px;
            padding: 4px 12px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 0;
            width: 20%;
            transition: all 0.2s ease;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item svg {
            width: 24px;
            height: 24px;
            margin-bottom: 4px;
        }

        .sparkle {
            position: absolute;
            pointer-events: none;
            z-index: 10;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: white;
            box-shadow: 0 0 10px 2px gold;
            animation: sparkle 0.8s linear forwards;
        }

        @keyframes sparkle {
            0% { transform: scale(0); opacity: 0; }
            20% { transform: scale(1); opacity: 1; }
            80% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        /* Plant growth stages */
        .plant-container {
            position: relative;
            height: 300px;
            margin: auto;
            width: 300px;
        }

        .plant-pot {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 70px;
            background: linear-gradient(to bottom, #e3a066, #c47d45);
            border-radius: 0 0 60px 60px;
            z-index: 1;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .plant-pot::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            height: 20px;
            background: #e3a066;
            border-radius: 10px;
        }

        .plant-soil {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 20px;
            background: #6e4c31;
            border-radius: 50%;
            z-index: 2;
        }

        .plant-stem {
            position: absolute;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            background: #52C49F;
            z-index: 1;
            transition: height 1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .plant-leaf {
            position: absolute;
            width: 25px;
            height: 15px;
            background: #7CE1C2;
            border-radius: 50% 50% 50% 0;
            z-index: 0;
            transform-origin: bottom right;
            transform: rotate(45deg);
            transition: all 0.5s ease;
            opacity: 0;
        }

        .plant-leaf.left {
            transform: scaleX(-1) rotate(45deg);
            transform-origin: bottom left;
        }

        .plant-flower {
            position: absolute;
            width: 40px;
            height: 40px;
            background: var(--primary-light);
            border-radius: 50%;
            z-index: 3;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: all 0.5s ease;
            box-shadow: 0 0 20px rgba(93, 92, 222, 0.4);
        }

        .plant-flower::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 15px;
            height: 15px;
            background: var(--secondary);
            border-radius: 50%;
        }

        /* Ripple effect */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.6);
            transform: scale(0);
            animation: ripple 0.6s linear;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Water drop animation */
        .water-drop {
            position: absolute;
            width: 15px;
            height: 20px;
            background-color: #7FB3D5;
            border-radius: 50% 50% 0 50%;
            transform: rotate(45deg);
            animation: drop 1.5s ease-in forwards;
            opacity: 0;
            z-index: 4;
        }

        @keyframes drop {
            0% {
                top: 50px;
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            80% {
                opacity: 1;
            }
            100% {
                top: 220px;
                opacity: 0;
                transform: rotate(45deg) scale(0.5);
            }
        }

        /* Screens and navigation */
        .screen {
            display: none;
            height: 100vh;
            width: 100vw;
            overflow-y: auto;
            position: relative;
            padding-bottom: 80px; /* Space for bottom nav */
        }

        .screen.active {
            display: block;
        }

        /* Bottom navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--background-light);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }

        .dark .bottom-nav {
            background-color: var(--background-dark);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
        }

        /* Achievement badges */
        .achievement {
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .achievement-icon {
            background-color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: var(--primary);
            font-size: 20px;
        }

        /* Settings switches */
        .switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        /* Language selector */
        .language-selector {
            position: relative;
        }

        .language-options {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--card-light);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 10px 0;
            display: none;
            z-index: 10;
            min-width: 150px;
        }

        .language-option {
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .language-option:hover {
            background-color: var(--card-dark);
        }

        .language-selector.open .language-options {
            display: block;
        }

        /* Onboarding/intro */
        .intro-slide {
            display: none;
            height: 100vh;
            width: 100%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
        }

        .intro-slide.active {
            display: flex;
        }

        .intro-indicator {
            display: flex;
            margin-top: 2rem;
        }

        .intro-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #E5E7EB;
            margin: 0 5px;
        }

        .intro-dot.active {
            background-color: var(--primary);
            transform: scale(1.2);
        }

        /* Gratitude entry animation */
        .gratitude-entry {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.5s forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Leaderboard styles */
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid #e5e7eb;
            transition: all 0.2s ease;
        }

        .leaderboard-item:hover {
            background-color: var(--card-dark);
        }

        .leaderboard-rank {
            font-weight: 700;
            width: 30px;
            text-align: center;
        }

        .leaderboard-user {
            flex: 1;
            display: flex;
            align-items: center;
        }

        .leaderboard-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-light);
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .leaderboard-score {
            font-weight: 600;
            color: var(--tertiary);
        }

        /* Top ranks styling */
        .leaderboard-item:nth-child(1) .leaderboard-rank {
            color: gold;
        }

        .leaderboard-item:nth-child(2) .leaderboard-rank {
            color: silver;
        }

        .leaderboard-item:nth-child(3) .leaderboard-rank {
            color: #cd7f32; /* bronze */
        }

        .seed-title {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
        }

        .seed-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Loading animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .dark .loading-overlay {
            background-color: rgba(24, 24, 24, 0.9);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Loading overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p id="loadingText">æ­£åœ¨è¿æ¥åˆ°æ„Ÿæ©èŠ±å›­...</p>
    </div>

    <!-- Onboarding / Intro -->
    <div id="intro" class="screen active">
        <div class="intro-slide active" id="intro-slide-1">
            <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f331.svg" alt="Seedling" class="w-32 h-32 mb-8 floating">
            <h1 class="text-3xl font-bold mb-4">æ¬¢è¿æ¥åˆ°æ„Ÿæ©ç§å­</h1>
            <p class="text-lg mb-8">åœ¨è¿™é‡Œï¼Œæ¯ä¸€æ¬¡æ„Ÿæ©éƒ½èƒ½è®©ä½ çš„ç§å­ç”Ÿé•¿ï¼Œè§è¯å†…åœ¨ç¾å¾·çš„ç»½æ”¾</p>
            <button class="button px-10 py-4 text-lg" onclick="nextIntroSlide()">å¼€å§‹æ—…ç¨‹</button>
        </div>
        
        <div class="intro-slide" id="intro-slide-2">
            <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f4d6.svg" alt="Book" class="w-32 h-32 mb-8">
            <h1 class="text-3xl font-bold mb-4">è®°å½•æ„Ÿæ©æ—¶åˆ»</h1>
            <p class="text-lg mb-8">æ¯å¤©è®°å½•å€¼å¾—æ„Ÿæ©çš„äº‹ç‰©ï¼ŒçŒæº‰ä½ çš„æ„Ÿæ©ç§å­</p>
            <button class="button px-10 py-4 text-lg" onclick="nextIntroSlide()">ç»§ç»­</button>
        </div>

        <div class="intro-slide" id="intro-slide-3">
            <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f33c.svg" alt="Flower" class="w-32 h-32 mb-8">
            <h1 class="text-3xl font-bold mb-4">æ”¶é›†ç¾å¾·ç§å­</h1>
            <p class="text-lg mb-8">é€šè¿‡æŒç»­æ„Ÿæ©ï¼Œå‘ç°å¹¶åŸ¹å…»è‡ªèº«çš„ç¾å¥½å“è´¨</p>
            <button class="button px-10 py-4 text-lg" onclick="nextIntroSlide()">ç»§ç»­</button>
        </div>

        <div class="intro-slide" id="intro-slide-4">
            <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f308.svg" alt="Rainbow" class="w-32 h-32 mb-8">
            <h1 class="text-3xl font-bold mb-4">è®¤é¢†ä½ çš„ç¬¬ä¸€é¢—ç§å­</h1>
            <p class="text-lg mb-8">è®©æˆ‘ä»¬å¼€å§‹è¿™æ®µå¥‡å¦™çš„æˆé•¿ä¹‹æ—…å§ï¼</p>
            <button class="button px-10 py-4 text-lg" onclick="claimFirstSeed()">è®¤é¢†ç§å­</button>
        </div>

        <div class="intro-indicator">
            <div class="intro-dot active" data-slide="1"></div>
            <div class="intro-dot" data-slide="2"></div>
            <div class="intro-dot" data-slide="3"></div>
            <div class="intro-dot" data-slide="4"></div>
        </div>
    </div>

    <!-- Home Screen -->
    <div id="homeScreen" class="screen p-4">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold">æˆ‘çš„æ„Ÿæ©èŠ±å›­</h2>
            <div class="flex items-center">
                <div class="badge mr-2" id="streakBadge">è¿ç»­ 0 å¤©</div>
                <div class="language-selector">
                    <button class="p-2" onclick="toggleLanguageSelector()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="2" y1="12" x2="22" y2="12"></line>
                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                        </svg>
                    </button>
                    <div class="language-options">
                        <div class="language-option" onclick="changeLanguage('zh-CN')">ä¸­æ–‡ (ç®€ä½“)</div>
                        <div class="language-option" onclick="changeLanguage('en-US')">English</div>
                        <div class="language-option" onclick="changeLanguage('ja-JP')">æ—¥æœ¬èª</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="plant-container" id="plantContainer">
            <div class="plant-pot"></div>
            <div class="plant-soil"></div>
            <div class="plant-stem" id="plantStem" style="height: 10px;"></div>
            <!-- Leaves and flower will be added by JavaScript -->
        </div>

        <div class="card p-4 mb-4">
            <h3 class="text-lg font-semibold mb-2">ä»Šæ—¥èƒ½é‡: <span id="dailyEnergy">20</span>/100</h3>
            <div class="w-full bg-gray-200 rounded-full h-3 mb-3">
                <div class="bg-blue-500 rounded-full h-3" id="energyBar" style="width: 20%"></div>
            </div>
            <p class="text-sm text-gray-600 dark:text-gray-400">è®°å½•æ„Ÿæ©äº‹é¡¹æ¥è·å–èƒ½é‡ï¼Œå¸®åŠ©ä½ çš„æ¤ç‰©ç”Ÿé•¿</p>
        </div>

        <div class="flex justify-center mb-6">
            <button id="waterPlantBtn" class="button button-tertiary flex items-center justify-center px-8 py-4 text-lg">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                    <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
                </svg>
                è®°å½•æ„Ÿæ©
            </button>
        </div>

        <h3 class="text-xl font-bold mb-4">æœ€è¿‘çš„æ„Ÿæ©æ—¶åˆ»</h3>
        <div id="recentGratitude" class="space-y-4">
            <!-- Entries will be added here by JavaScript -->
        </div>
    </div>

    <!-- Journal Entry Screen -->
    <div id="journalScreen" class="screen p-4">
        <div class="flex justify-between items-center mb-6">
            <button onclick="switchScreen('homeScreen')" class="p-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>
            <h2 class="text-2xl font-bold">è®°å½•æ„Ÿæ©</h2>
            <div class="w-8"></div> <!-- For balance -->
        </div>

        <div class="card p-4 mb-6">
            <p class="text-lg mb-4">ä»Šå¤©ï¼Œæˆ‘æ„Ÿæ©...</p>
            <textarea id="gratitudeInput" class="input w-full h-32 mb-4" placeholder="ä¾‹å¦‚: æ„Ÿè°¢ä»Šå¤©é˜³å…‰æ˜åªšçš„å¤©æ°”è®©æˆ‘å¿ƒæƒ…æ„‰å¿«..."></textarea>
            
            <div class="flex justify-between mb-4">
                <div class="flex items-center">
                    <label class="text-sm mr-2">ç±»å‹:</label>
                    <select id="gratitudeType" class="input py-2">
                        <option value="general">æ—¥å¸¸ç”Ÿæ´»</option>
                        <option value="people">äººé™…å…³ç³»</option>
                        <option value="self">è‡ªæˆ‘æˆé•¿</option>
                        <option value="nature">è‡ªç„¶ä¸‡ç‰©</option>
                        <option value="challenge">æŒ‘æˆ˜ä¸å­¦ä¹ </option>
                    </select>
                </div>
                
                <div class="flex items-center">
                    <label class="text-sm mr-2">å¿ƒæƒ…:</label>
                    <select id="gratitudeMood" class="input py-2">
                        <option value="joyful">ğŸ˜Š æ„‰å¿«</option>
                        <option value="peaceful">ğŸ˜Œ å¹³é™</option>
                        <option value="hopeful">ğŸŒŸ å¸Œæœ›</option>
                        <option value="grateful">ğŸ™ æ„Ÿæ¿€</option>
                        <option value="content">ğŸ˜Š æ»¡è¶³</option>
                    </select>
                </div>
            </div>
            
            <div class="text-center">
                <button id="saveGratitudeBtn" class="button px-10 py-3" onclick="saveGratitude()">ä¿å­˜</button>
            </div>
        </div>

        <div class="card p-4 mb-4">
            <h3 class="text-lg font-semibold mb-2">çµæ„Ÿæç¤º</h3>
            <div class="space-y-2">
                <p class="p-2 bg-gray-100 dark:bg-gray-800 rounded-lg">"ä»Šå¤©è®©æˆ‘å¾®ç¬‘çš„ä¸€ä»¶å°äº‹æ˜¯..."</p>
                <p class="p-2 bg-gray-100 dark:bg-gray-800 rounded-lg">"æˆ‘ä»ä»Šå¤©çš„æŒ‘æˆ˜ä¸­å­¦åˆ°äº†..."</p>
                <p class="p-2 bg-gray-100 dark:bg-gray-800 rounded-lg">"æˆ‘æ„Ÿè°¢çš„ä¸€ä¸ªäººæ˜¯...å› ä¸º..."</p>
            </div>
        </div>
    </div>

    <!-- Almanac/Collection Screen -->
    <div id="collectionScreen" class="screen p-4">
        <h2 class="text-2xl font-bold mb-6">ç¾å¾·ç§å­å›¾é‰´</h2>
        
        <div class="flex justify-between mb-4">
            <p>å·²æ”¶é›†: <span id="seedCount">3</span>/12</p>
            <div>
                <select id="seedFilter" class="input py-1">
                    <option value="all">å…¨éƒ¨ç§å­</option>
                    <option value="collected">å·²æ”¶é›†</option>
                    <option value="uncollected">æœªæ”¶é›†</option>
                </select>
            </div>
        </div>
        
        <div class="grid grid-cols-2 gap-4" id="seedCollection">
            <!-- Seeds will be added here by JavaScript -->
        </div>
    </div>

    <!-- Seed Detail Screen -->
    <div id="seedDetailScreen" class="screen p-4 hidden">
        <div class="flex justify-between items-center mb-6">
            <button onclick="switchScreen('collectionScreen')" class="p-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>
            <h2 class="text-2xl font-bold" id="seedDetailTitle">ç§å­è¯¦æƒ…</h2>
            <div class="w-8"></div> <!-- For balance -->
        </div>

        <div class="card p-6 mb-6">
            <div class="flex justify-center mb-4">
                <img id="seedDetailImage" src="" alt="Seed" class="w-32 h-32">
            </div>
            <h3 class="text-xl font-bold mb-2 text-center" id="seedDetailName"></h3>
            <p class="text-center mb-4" id="seedDetailStatus"></p>
            <p class="mb-4" id="seedDetailDescription"></p>
            
            <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg mb-4">
                <h4 class="font-semibold mb-2">å¯“æ„è§£è¯»</h4>
                <p id="seedDetailMeaning"></p>
            </div>
            
            <div id="seedUpgradeSection" class="hidden">
                <h4 class="font-semibold mb-2">ä¸ªæ€§åŒ–</h4>
                <button class="button button-outline w-full mb-2">é‡å‘½å</button>
                <button class="button button-outline w-full">æ›´æ–°å½¢è±¡</button>
            </div>
        </div>

        <div class="card p-4 mb-4" id="seedAchievementSection">
            <h3 class="text-lg font-semibold mb-2">è·å–æç¤º</h3>
            <p id="seedAchievementHint">æŒç»­è®°å½•ä¸"å–œæ‚¦"ç›¸å…³çš„æ„Ÿæ©äº‹é¡¹ï¼Œæˆ–å®Œæˆç‰¹å®šçš„æŒ‘æˆ˜ä»»åŠ¡æ¥è·å¾—è¿™é¢—ç§å­ã€‚</p>
        </div>
    </div>

    <!-- Profile Screen -->
    <div id="profileScreen" class="screen p-4">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold">ä¸ªäººèµ„æ–™</h2>
            <button onclick="switchScreen('settingsScreen')" class="p-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
            </button>
        </div>

        <div class="card p-6 mb-6 text-center">
            <div class="flex justify-center mb-4">
                <div class="w-24 h-24 bg-primary rounded-full flex items-center justify-center text-white text-2xl font-bold">
                    YZ
                </div>
            </div>
            <h3 class="text-xl font-bold">å‹‡è€…</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">æ„Ÿæ©ç»ƒä¹ ç¬¬ 7 å¤©</p>
            
            <div class="flex justify-around">
                <div>
                    <p class="text-2xl font-bold">30</p>
                    <p class="text-sm">æ„Ÿæ©è®°å½•</p>
                </div>
                <div>
                    <p class="text-2xl font-bold">5</p>
                    <p class="text-sm">ç§å­æ”¶é›†</p>
                </div>
                <div>
                    <p class="text-2xl font-bold">7</p>
                    <p class="text-sm">è¿ç»­å¤©æ•°</p>
                </div>
            </div>
        </div>

        <div class="mb-6">
            <h3 class="text-xl font-bold mb-4">æˆå°±å¾½ç« </h3>
            <div class="space-y-3">
                <div class="achievement">
                    <div class="achievement-icon">ğŸŒ±</div>
                    <div>
                        <p class="font-semibold">æ’­ç§è€…</p>
                        <p class="text-sm text-white">è®°å½•ç¬¬ä¸€æ¡æ„Ÿæ©ç¬”è®°</p>
                    </div>
                </div>
                <div class="achievement">
                    <div class="achievement-icon">ğŸ”¥</div>
                    <div>
                        <p class="font-semibold">æŒç»­ä¸€å‘¨</p>
                        <p class="text-sm text-white">è¿ç»­7å¤©è®°å½•æ„Ÿæ©</p>
                    </div>
                </div>
                <div class="achievement">
                    <div class="achievement-icon">ğŸŒ»</div>
                    <div>
                        <p class="font-semibold">æ”¶è—å®¶</p>
                        <p class="text-sm text-white">æ”¶é›†5ç§ä¸åŒçš„ç¾å¾·ç§å­</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="card p-4 mb-6">
            <h3 class="text-lg font-semibold mb-4">æ’è¡Œæ¦œ</h3>
            <div class="leaderboard">
                <div class="leaderboard-item">
                    <div class="leaderboard-rank">1</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-avatar">LW</div>
                        <div>æè–‡</div>
                    </div>
                    <div class="leaderboard-score">96å¤©</div>
                </div>
                <div class="leaderboard-item">
                    <div class="leaderboard-rank">2</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-avatar">ZM</div>
                        <div>å¼ æ˜</div>
                    </div>
                    <div class="leaderboard-score">82å¤©</div>
                </div>
                <div class="leaderboard-item">
                    <div class="leaderboard-rank">3</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-avatar">WJ</div>
                        <div>ç‹é™</div>
                    </div>
                    <div class="leaderboard-score">65å¤©</div>
                </div>
                <div class="leaderboard-item">
                    <div class="leaderboard-rank">4</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-avatar">YZ</div>
                        <div>å‹‡è€… (ä½ )</div>
                    </div>
                    <div class="leaderboard-score">7å¤©</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Screen -->
    <div id="settingsScreen" class="screen p-4">
        <div class="flex justify-between items-center mb-6">
            <button onclick="switchScreen('profileScreen')" class="p-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>
            <h2 class="text-2xl font-bold">è®¾ç½®</h2>
            <div class="w-8"></div> <!-- For balance -->
        </div>

        <div class="card p-4 mb-4">
            <h3 class="text-lg font-semibold mb-4">é€šçŸ¥è®¾ç½®</h3>
            <div class="flex justify-between items-center mb-3">
                <span>æ¯æ—¥æé†’</span>
                <label class="switch">
                    <input type="checkbox" checked="">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="flex justify-between items-center mb-3">
                <span>æé†’æ—¶é—´</span>
                <select class="input py-1">
                    <option>æ—©ä¸Š 8:00</option>
                    <option>ä¸­åˆ 12:00</option>
                    <option selected="">æ™šä¸Š 9:00</option>
                    <option>æ™šä¸Š 10:00</option>
                </select>
            </div>
            <div class="flex justify-between items-center">
                <span>æˆå°±é€šçŸ¥</span>
                <label class="switch">
                    <input type="checkbox" checked="">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="card p-4 mb-4">
            <h3 class="text-lg font-semibold mb-4">åº”ç”¨è®¾ç½®</h3>
            <div class="flex justify-between items-center mb-3">
                <span>æš—é»‘æ¨¡å¼</span>
                <label class="switch">
                    <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="flex justify-between items-center mb-3">
                <span>è¯­è¨€</span>
                <select class="input py-1" id="languageSelect" onchange="updateLanguage()">
                    <option value="zh-CN" selected="">ä¸­æ–‡</option>
                    <option value="en-US">English</option>
                    <option value="ja-JP">æ—¥æœ¬èª</option>
                </select>
            </div>
            <div class="flex justify-between items-center">
                <span>å£°éŸ³æ•ˆæœ</span>
                <label class="switch">
                    <input type="checkbox" checked="">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="card p-4 mb-4">
            <h3 class="text-lg font-semibold mb-4">å…³äº</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-2">æ„Ÿæ©ç§å­ v1.0.0</p>
            <p class="text-gray-600 dark:text-gray-400 mb-2">ä¸€æ¬¾å¸®åŠ©åŸ¹å…»æ„Ÿæ©ä¹ æƒ¯çš„åº”ç”¨</p>
            <div class="flex justify-between items-center mb-2">
                <span>éšç§æ”¿ç­–</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </div>
            <div class="flex justify-between items-center">
                <span>ä½¿ç”¨æ¡æ¬¾</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchNav('homeScreen', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
            <span class="text-xs">é¦–é¡µ</span>
        </div>
        <div class="nav-item" onclick="switchNav('collectionScreen', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
            </svg>
            <span class="text-xs">å›¾é‰´</span>
        </div>
        <div class="nav-item" onclick="switchNav('journalScreen', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
            <span class="text-xs">è®°å½•</span>
        </div>
        <div class="nav-item" onclick="switchNav('profileScreen', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span class="text-xs">æˆ‘çš„</span>
        </div>
    </div>

    <script>
        // Simulate loading screen for demo
        setTimeout(() => {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }, 1500);

        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
            document.getElementById('darkModeToggle').checked = true;
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
                document.getElementById('darkModeToggle').checked = true;
            } else {
                document.documentElement.classList.remove('dark');
                document.getElementById('darkModeToggle').checked = false;
            }
        });

        // Variables to track app state
        let currentIntroSlide = 1;
        const totalIntroSlides = 4;
        let gratitudeCount = 0;
        let streakCount = 0;
        let plantGrowthStage = 0;
        const maxGrowthStage = 5;
        let energy = 20;
        
        // Sample seed data
        const seeds = [
            {
                id: 'gratitude',
                name: 'æ„Ÿæ©',
                description: 'å­¦ä¼šæ„Ÿè°¢ç”Ÿæ´»ä¸­çš„ä¸€åˆ‡ï¼Œæ— è®ºå¤§å°ã€‚',
                meaning: 'æ„Ÿæ©æ˜¯å¹¸ç¦çš„åŸºçŸ³ï¼Œå®ƒè®©æˆ‘ä»¬è®¤è¯†åˆ°ç”Ÿæ´»ä¸­çš„æ©èµï¼ŒåŸ¹å…»æˆ‘ä»¬å¯¹ç°æœ‰äº‹ç‰©çš„çè§†ä¹‹æƒ…ã€‚',
                emoji: 'ğŸ™',
                collected: true
            },
            {
                id: 'joy',
                name: 'å–œæ‚¦',
                description: 'ä»ç®€å•çš„äº‹ç‰©ä¸­å¯»æ‰¾å¿«ä¹ã€‚',
                meaning: 'å–œæ‚¦æ˜¯ä¸€ç§å†…åœ¨çš„ç”Ÿå‘½åŠ›ï¼Œè®©æˆ‘ä»¬ä»æ—¥å¸¸çš„ç®€å•äº‹ç‰©ä¸­æ‰¾åˆ°æ¬¢ä¹ï¼Œç…§äº®æˆ‘ä»¬çš„å†…å¿ƒä¸–ç•Œã€‚',
                emoji: 'ğŸ˜Š',
                collected: true
            },
            {
                id: 'peace',
                name: 'å¹³é™',
                description: 'åœ¨æ··ä¹±ä¸­ä¿æŒå†…å¿ƒçš„å¹³é™ã€‚',
                meaning: 'å¹³é™æ˜¯å†…å¿ƒçš„å®é™ï¼Œè®©æˆ‘ä»¬åœ¨å¤–ç•Œçº·æ‰°ä¸­ä¿æŒç¨³å®šï¼Œæ‰¾åˆ°è‡ªå·±çš„å¹³è¡¡ç‚¹ã€‚',
                emoji: 'ğŸ•Šï¸',
                collected: true
            },
            {
                id: 'patience',
                name: 'è€å¿ƒ',
                description: 'å­¦ä¼šç­‰å¾…ï¼Œç›¸ä¿¡æ—¶é—´çš„åŠ›é‡ã€‚',
                meaning: 'è€å¿ƒæ˜¯ä¸€ç§é™å¾…èŠ±å¼€çš„èƒ½åŠ›ï¼Œè®©æˆ‘ä»¬åœ¨ç­‰å¾…ä¸­åŸ¹å…»åšéŸ§å’Œä¿¡å¿µï¼Œä¸æ€¥ä¸èºåœ°è¿æ¥ç”Ÿæ´»çš„å˜åŒ–ã€‚',
                emoji: 'â³',
                collected: false
            },
            {
                id: 'kindness',
                name: 'å–„è‰¯',
                description: 'å¯¹ä»–äººæ€€æœ‰çœŸè¯šçš„å…³å¿ƒå’ŒåŒæƒ…ã€‚',
                meaning: 'å–„è‰¯æ˜¯äººæ€§ä¸­æœ€ç¾çš„å…‰è¾‰ï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿå…³çˆ±ä»–äººï¼Œä¼ é€’æ¸©æš–ï¼Œåˆ›é€ æ›´å’Œè°çš„ä¸–ç•Œã€‚',
                emoji: 'ğŸ’–',
                collected: false
            },
            {
                id: 'courage',
                name: 'å‹‡æ°”',
                description: 'å³ä½¿å®³æ€•ï¼Œä¾ç„¶å‹‡æ•¢å‰è¡Œã€‚',
                meaning: 'å‹‡æ°”å¹¶éæ²¡æœ‰ææƒ§ï¼Œè€Œæ˜¯åœ¨é¢å¯¹ææƒ§æ—¶ä¾ç„¶å‰è¡Œã€‚å®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿé¢å¯¹æŒ‘æˆ˜ï¼Œçªç ´è‡ªæˆ‘é™åˆ¶ã€‚',
                emoji: 'ğŸ¦',
                collected: false
            },
            {
                id: 'wisdom',
                name: 'æ™ºæ…§',
                description: 'å°†çŸ¥è¯†è½¬åŒ–ä¸ºç”Ÿæ´»çš„æŒ‡å—ã€‚',
                meaning: 'æ™ºæ…§æ˜¯çŸ¥è¯†å’Œç»éªŒçš„ç»“æ™¶ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿæ˜è¾¨æ˜¯éï¼Œåšå‡ºæ˜æ™ºçš„å†³å®šï¼ŒæŒ‡å¼•ç”Ÿæ´»çš„æ–¹å‘ã€‚',
                emoji: 'ğŸ¦‰',
                collected: false
            },
            {
                id: 'humility',
                name: 'è°¦å‘',
                description: 'è®¤è¯†è‡ªå·±çš„å±€é™ï¼Œæ„¿æ„å­¦ä¹ å’Œæˆé•¿ã€‚',
                meaning: 'è°¦å‘ä¸æ˜¯è‡ªå‘ï¼Œè€Œæ˜¯å¯¹è‡ªå·±èƒ½åŠ›å’Œé™åˆ¶çš„æ­£ç¡®è®¤è¯†ï¼Œä¿æŒå¼€æ”¾çš„å¿ƒæ€ï¼Œæ„¿æ„ä¸æ–­å­¦ä¹ å’Œè¿›æ­¥ã€‚',
                emoji: 'ğŸŒ±',
                collected: false
            },
            {
                id: 'compassion',
                name: 'åŒç†å¿ƒ',
                description: 'èƒ½å¤Ÿç†è§£å¹¶æ„Ÿå—ä»–äººçš„æƒ…æ„Ÿã€‚',
                meaning: 'åŒç†å¿ƒæ˜¯æ„Ÿå—ä»–äººæƒ…æ„Ÿçš„èƒ½åŠ›ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿç«™åœ¨ä»–äººçš„è§’åº¦æ€è€ƒé—®é¢˜ï¼Œå»ºç«‹æ›´æ·±åˆ»çš„è¿æ¥ã€‚',
                emoji: 'ğŸ¤²',
                collected: false
            },
            {
                id: 'honesty',
                name: 'è¯šå®',
                description: 'è¨€è¡Œä¸€è‡´ï¼ŒçœŸå®åœ°è¡¨è¾¾è‡ªå·±ã€‚',
                meaning: 'è¯šå®æ˜¯å“æ ¼çš„åŸºçŸ³ï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤ŸçœŸå®åœ°é¢å¯¹è‡ªå·±å’Œä»–äººï¼Œå»ºç«‹ä¿¡ä»»ï¼Œæ´»å‡ºçœŸå®çš„è‡ªæˆ‘ã€‚',
                emoji: 'ğŸ”',
                collected: false
            },
            {
                id: 'forgiveness',
                name: 'å®½æ•',
                description: 'é‡Šæ”¾è¿‡å»çš„ä¼¤å®³ï¼Œç»™è‡ªå·±å’Œä»–äººæ–°çš„å¼€å§‹ã€‚',
                meaning: 'å®½æ•æ˜¯ä¸€ç§é‡Šæ”¾ï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿæ”¾ä¸‹è¿‡å»çš„ä¼¤å®³ï¼Œå‡è½»å†…å¿ƒçš„è´Ÿæ‹…ï¼Œå‘æœªæ¥æ•å¼€å¿ƒæ‰‰ã€‚',
                emoji: 'ğŸ•Šï¸',
                collected: false
            },
            {
                id: 'perseverance',
                name: 'æ¯…åŠ›',
                description: 'å³ä½¿å›°éš¾é‡é‡ï¼Œä¾ç„¶åšæŒä¸æ‡ˆã€‚',
                meaning: 'æ¯…åŠ›æ˜¯åšæŒä¸æ‡ˆçš„å†³å¿ƒï¼Œè®©æˆ‘ä»¬åœ¨é¢å¯¹æŒ«æŠ˜æ—¶ä¸è½»æ˜“æ”¾å¼ƒï¼ŒæŒç»­æœç€ç›®æ ‡å‰è¿›ã€‚',
                emoji: 'ğŸ”ï¸',
                collected: false
            }
        ];

        // Sample gratitude entries
        const sampleGratitudes = [
            {
                text: "ä»Šå¤©é˜³å…‰æ˜åªšï¼Œæˆ‘å¾ˆæ„Ÿæ¿€èƒ½åœ¨å…¬å›­é‡Œæ•£æ­¥ï¼Œäº«å—å¤§è‡ªç„¶çš„ç¾ä¸½ã€‚",
                type: "nature",
                mood: "joyful",
                date: "2023-10-25"
            },
            {
                text: "æ„Ÿè°¢æœ‹å‹åœ¨æˆ‘éœ€è¦æ—¶çš„æ”¯æŒå’Œé¼“åŠ±ï¼Œè®©æˆ‘æ„Ÿåˆ°è¢«å…³å¿ƒå’Œç†è§£ã€‚",
                type: "people",
                mood: "grateful",
                date: "2023-10-24"
            },
            {
                text: "ä»Šå¤©å®Œæˆäº†ä¸€ä¸ªå›°éš¾çš„é¡¹ç›®ï¼Œæˆ‘æ„Ÿè°¢è‡ªå·±çš„åšæŒå’ŒåŠªåŠ›ã€‚",
                type: "self",
                mood: "content",
                date: "2023-10-23"
            }
        ];
        
        // Initialize the app
        function initApp() {
            updateSeedCount();
            renderSeedCollection();
            renderRecentGratitudes();
            
            document.getElementById('waterPlantBtn').addEventListener('click', () => {
                switchScreen('journalScreen');
                switchNav('journalScreen', document.querySelectorAll('.nav-item')[2]);
            });

            document.getElementById('seedFilter').addEventListener('change', renderSeedCollection);
        }

        // Intro slide navigation
        function nextIntroSlide() {
            if (currentIntroSlide < totalIntroSlides) {
                document.getElementById(`intro-slide-${currentIntroSlide}`).classList.remove('active');
                currentIntroSlide++;
                document.getElementById(`intro-slide-${currentIntroSlide}`).classList.add('active');
                
                // Update dots
                document.querySelectorAll('.intro-dot').forEach(dot => {
                    dot.classList.remove('active');
                });
                document.querySelector(`.intro-dot[data-slide="${currentIntroSlide}"]`).classList.add('active');
            }
        }

        // Claim first seed and go to main app
        function claimFirstSeed() {
            // Show seed claiming animation
            const introScreen = document.getElementById('intro');
            introScreen.innerHTML = `
                <div class="flex flex-col items-center justify-center h-full p-4 text-center">
                    <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f331.svg" alt="Seedling" class="w-32 h-32 mb-8 bounce">
                    <h2 class="text-2xl font-bold mb-4">æ­å–œä½ è·å¾—ç¬¬ä¸€é¢—ç§å­ï¼</h2>
                    <p class="text-lg mb-8">è¿™æ˜¯ä½ æ„Ÿæ©ä¹‹æ—…çš„å¼€å§‹</p>
                    <button class="button px-10 py-4 text-lg" onclick="startMainApp()">å¼€å§‹æ¢ç´¢</button>
                </div>
            `;
            
            // Add sparkle animation
            for (let i = 0; i < 10; i++) {
                setTimeout(() => addSparkle(), i * 300);
            }
        }

        // Add sparkle effect
        function addSparkle() {
            const sparkle = document.createElement('div');
            sparkle.classList.add('sparkle');
            
            const intro = document.getElementById('intro');
            const centerX = intro.offsetWidth / 2;
            const centerY = intro.offsetHeight / 2;
            
            const angle = Math.random() * Math.PI * 2;
            const distance = 100 + Math.random() * 100;
            
            const x = centerX + Math.cos(angle) * distance;
            const y = centerY + Math.sin(angle) * distance;
            
            sparkle.style.left = `${x}px`;
            sparkle.style.top = `${y}px`;
            
            intro.appendChild(sparkle);
            
            setTimeout(() => {
                sparkle.remove();
            }, 800);
        }

        // Start main app after intro
        function startMainApp() {
            switchScreen('homeScreen');
            document.querySelector('.bottom-nav').style.display = 'flex';
            
            // Initialize with some data
            streakCount = 7;
            document.getElementById('streakBadge').textContent = `è¿ç»­ ${streakCount} å¤©`;
            
            growPlant(1);
        }

        // Switch between screens
        function switchScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // Switch between nav items
        function switchNav(screenId, navItem) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            navItem.classList.add('active');
            switchScreen(screenId);
        }

        // Toggle dark mode
        function toggleDarkMode() {
            const darkModeEnabled = document.getElementById('darkModeToggle').checked;
            if (darkModeEnabled) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        // Toggle language selector
        function toggleLanguageSelector() {
            const selector = document.querySelector('.language-selector');
            selector.classList.toggle('open');
        }

        // Change language
        function changeLanguage(lang) {
            document.getElementById('languageSelect').value = lang;
            updateLanguage();
            toggleLanguageSelector();
        }

        // Update language (demo only shows message)
        function updateLanguage() {
            const lang = document.getElementById('languageSelect').value;
            console.log(`Language changed to: ${lang}`);
            // In a real app, this would update all text elements
        }

        // Save gratitude entry
        function saveGratitude() {
            const gratitudeText = document.getElementById('gratitudeInput').value.trim();
            const gratitudeType = document.getElementById('gratitudeType').value;
            const gratitudeMood = document.getElementById('gratitudeMood').value;
            
            if (gratitudeText === '') {
                alert('è¯·è¾“å…¥æ„Ÿæ©å†…å®¹');
                return;
            }
            
            // Create new gratitude object
            const newGratitude = {
                text: gratitudeText,
                type: gratitudeType,
                mood: gratitudeMood,
                date: new Date().toISOString().split('T')[0]
            };
            
            // Add to beginning of the list
            sampleGratitudes.unshift(newGratitude);
            
            // Clear the input
            document.getElementById('gratitudeInput').value = '';
            
            // Update UI
            renderRecentGratitudes();
            growPlant(plantGrowthStage + 1);
            updateEnergy(energy + 20);
            
            // Show water animation
            addWaterDrop();
            
            // Switch back to home screen
            switchScreen('homeScreen');
            switchNav('homeScreen', document.querySelectorAll('.nav-item')[0]);
            
            // Display success message
            const successMessage = document.createElement('div');
            successMessage.classList.add('fixed', 'bottom-20', 'left-0', 'right-0', 'mx-auto', 'w-4/5', 'bg-green-500', 'text-white', 'p-4', 'rounded-lg', 'text-center');
            successMessage.style.zIndex = '1000';
            successMessage.textContent = 'æ„Ÿæ©è®°å½•å·²ä¿å­˜ï¼ä½ çš„æ¤ç‰©å¾—åˆ°äº†æ»‹å…»ã€‚';
            document.body.appendChild(successMessage);
            
            setTimeout(() => {
                successMessage.classList.add('transition-opacity', 'duration-500', 'opacity-0');
                setTimeout(() => {
                    successMessage.remove();
                }, 500);
            }, 3000);
        }

        // Add water drop animation
        function addWaterDrop() {
            const plantContainer = document.getElementById('plantContainer');
            const waterDrop = document.createElement('div');
            waterDrop.classList.add('water-drop');
            
            // Position at top center
            waterDrop.style.left = '50%';
            waterDrop.style.transform = 'translateX(-50%) rotate(45deg)';
            
            plantContainer.appendChild(waterDrop);
            
            // Remove after animation completes
            setTimeout(() => {
                waterDrop.remove();
            }, 1500);
        }

        // Update energy display
        function updateEnergy(newEnergy) {
            energy = Math.min(newEnergy, 100);
            document.getElementById('dailyEnergy').textContent = energy;
            document.getElementById('energyBar').style.width = `${energy}%`;
        }

        // Grow plant to specified stage
        function growPlant(stage) {
            plantGrowthStage = Math.min(stage, maxGrowthStage);
            
            const plantStem = document.getElementById('plantStem');
            const plantContainer = document.getElementById('plantContainer');
            
            // Clear existing leaves and flowers
            document.querySelectorAll('.plant-leaf, .plant-flower').forEach(el => el.remove());
            
            // Update stem height based on stage
            const heights = [10, 50, 90, 130, 170, 200];
            plantStem.style.height = `${heights[plantGrowthStage]}px`;
            
            // Add leaves based on stage
            if (plantGrowthStage >= 1) {
                // First set of leaves
                addLeaf(70, -15, false);
                addLeaf(70, 15, true);
            }
            
            if (plantGrowthStage >= 2) {
                // Second set of leaves
                addLeaf(100, -20, false);
                addLeaf(100, 20, true);
            }
            
            if (plantGrowthStage >= 3) {
                // Third set of leaves
                addLeaf(140, -25, false);
                addLeaf(140, 25, true);
                
                // Add small leaves
                addLeaf(120, -10, false, 0.7);
                addLeaf(120, 10, true, 0.7);
            }
            
            if (plantGrowthStage >= 4) {
                // More leaves
                addLeaf(170, -15, false, 0.8);
                addLeaf(170, 15, true, 0.8);
            }
            
            if (plantGrowthStage >= 5) {
                // Add flower
                const flower = document.createElement('div');
                flower.classList.add('plant-flower');
                flower.style.bottom = '210px';
                plantContainer.appendChild(flower);
                
                // Animate flower appearance
                setTimeout(() => {
                    flower.style.opacity = '1';
                }, 100);
            }
            
            // Make all leaves visible with staggered delay
            document.querySelectorAll('.plant-leaf').forEach((leaf, index) => {
                setTimeout(() => {
                    leaf.style.opacity = '1';
                }, 100 * index);
            });
        }

        // Add a leaf to the plant
        function addLeaf(bottom, leftOffset, isLeft, scale = 1) {
            const plantContainer = document.getElementById('plantContainer');
            const leaf = document.createElement('div');
            leaf.classList.add('plant-leaf');
            if (isLeft) leaf.classList.add('left');
            
            leaf.style.bottom = `${bottom}px`;
            leaf.style.left = `${50 + leftOffset}%`;
            
            if (scale !== 1) {
                leaf.style.transform = isLeft 
                    ? `scaleX(-1) rotate(45deg) scale(${scale})` 
                    : `rotate(45deg) scale(${scale})`;
            }
            
            plantContainer.appendChild(leaf);
        }

        // Update seed count
        function updateSeedCount() {
            const collectedSeeds = seeds.filter(seed => seed.collected).length;
            document.getElementById('seedCount').textContent = `${collectedSeeds}/${seeds.length}`;
        }

        // Render seed collection
        function renderSeedCollection() {
            const filter = document.getElementById('seedFilter').value;
            const seedCollection = document.getElementById('seedCollection');
            seedCollection.innerHTML = '';
            
            let filteredSeeds = seeds;
            if (filter === 'collected') {
                filteredSeeds = seeds.filter(seed => seed.collected);
            } else if (filter === 'uncollected') {
                filteredSeeds = seeds.filter(seed => !seed.collected);
            }
            
            filteredSeeds.forEach(seed => {
                const seedCard = document.createElement('div');
                seedCard.classList.add('card', 'seed-card', 'p-4', 'text-center');
                if (!seed.collected) {
                    seedCard.classList.add('opacity-50');
                }
                
                seedCard.innerHTML = `
                    <div class="text-5xl mb-2">${seed.emoji}</div>
                    <h3 class="font-bold">${seed.name}</h3>
                    <p class="text-sm">${seed.collected ? 'å·²æ”¶é›†' : 'æœªè·å¾—'}</p>
                `;
                
                seedCard.addEventListener('click', () => showSeedDetail(seed.id));
                seedCollection.appendChild(seedCard);
            });
        }

        // Show seed detail
        function showSeedDetail(seedId) {
            const seed = seeds.find(s => s.id === seedId);
            if (!seed) return;
            
            document.getElementById('seedDetailTitle').textContent = 'ç§å­è¯¦æƒ…';
            document.getElementById('seedDetailImage').src = `https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/${getEmojiHex(seed.emoji)}.svg`;
            document.getElementById('seedDetailName').textContent = seed.name;
            document.getElementById('seedDetailStatus').textContent = seed.collected ? 'å·²æ”¶é›†' : 'æœªè·å¾—';
            document.getElementById('seedDetailDescription').textContent = seed.description;
            document.getElementById('seedDetailMeaning').textContent = seed.meaning;
            
            if (seed.collected) {
                document.getElementById('seedAchievementSection').classList.add('hidden');
                document.getElementById('seedUpgradeSection').classList.remove('hidden');
            } else {
                document.getElementById('seedAchievementSection').classList.remove('hidden');
                document.getElementById('seedUpgradeSection').classList.add('hidden');
                document.getElementById('seedAchievementHint').textContent = `æŒç»­è®°å½•ä¸"${seed.name}"ç›¸å…³çš„æ„Ÿæ©äº‹é¡¹ï¼Œæˆ–å®Œæˆç‰¹å®šçš„æŒ‘æˆ˜ä»»åŠ¡æ¥è·å¾—è¿™é¢—ç§å­ã€‚`;
            }
            
            switchScreen('seedDetailScreen');
        }

        // Get emoji hex code for image URL
        function getEmojiHex(emoji) {
            // Simple mapping for demo
            const emojiMap = {
                'ğŸ™': '1f64f',
                'ğŸ˜Š': '1f60a',
                'ğŸ•Šï¸': '1f54a',
                'â³': '23f3',
                'ğŸ’–': '1f496',
                'ğŸ¦': '1f981',
                'ğŸ¦‰': '1f989',
                'ğŸŒ±': '1f331',
                'ğŸ¤²': '1f932',
                'ğŸ”': '1f50d',
                'ğŸ”ï¸': '1f3d4'
            };
            
            return emojiMap[emoji] || '1f331'; // Default to seedling
        }

        // Render recent gratitude entries
        function renderRecentGratitudes() {
            const recentContainer = document.getElementById('recentGratitude');
            recentContainer.innerHTML = '';
            
            sampleGratitudes.slice(0, 3).forEach((gratitude, index) => {
                const entry = document.createElement('div');
                entry.classList.add('card', 'p-4', 'gratitude-entry');
                entry.style.animationDelay = `${index * 0.1}s`;
                
                let moodEmoji = 'ğŸ˜Š';
                switch (gratitude.mood) {
                    case 'joyful': moodEmoji = 'ğŸ˜Š'; break;
                    case 'peaceful': moodEmoji = 'ğŸ˜Œ'; break;
                    case 'hopeful': moodEmoji = 'ğŸŒŸ'; break;
                    case 'grateful': moodEmoji = 'ğŸ™'; break;
                    case 'content': moodEmoji = 'ğŸ˜Š'; break;
                }
                
                const date = new Date(gratitude.date);
                const formattedDate = `${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥`;
                
                entry.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div class="badge">${getTypeLabel(gratitude.type)}</div>
                        <div class="text-sm text-gray-500">${formattedDate}</div>
                    </div>
                    <p class="mb-2">${gratitude.text}</p>
                    <div class="text-right">${moodEmoji}</div>
                `;
                
                recentContainer.appendChild(entry);
            });
        }

        // Helper to get type label
        function getTypeLabel(type) {
            switch (type) {
                case 'general': return 'æ—¥å¸¸ç”Ÿæ´»';
                case 'people': return 'äººé™…å…³ç³»';
                case 'self': return 'è‡ªæˆ‘æˆé•¿';
                case 'nature': return 'è‡ªç„¶ä¸‡ç‰©';
                case 'challenge': return 'æŒ‘æˆ˜ä¸å­¦ä¹ ';
                default: return 'æ—¥å¸¸ç”Ÿæ´»';
            }
        }

        // Add ripple effect on button clicks
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('button')) {
                const button = e.target;
                const ripple = document.createElement('span');
                ripple.classList.add('ripple');
                
                const buttonRect = button.getBoundingClientRect();
                const size = Math.max(buttonRect.width, buttonRect.height);
                
                ripple.style.width = ripple.style.height = `${size}px`;
                ripple.style.left = `${e.clientX - buttonRect.left - size / 2}px`;
                ripple.style.top = `${e.clientY - buttonRect.top - size / 2}px`;
                
                button.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            }
        });

        // Initialize app on load
        document.addEventListener('DOMContentLoaded', initApp);
    </script>


</body></html>